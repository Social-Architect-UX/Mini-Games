<!DOCTYPE html>
<html>
<head>
  <title>Glow Tag v2</title>
  <style>
    body {
      margin: 0;
      background: #000;
      overflow: hidden;
      font-family: sans-serif;
      color: white;
    }

    #ui {
      position: fixed;
      top: 10px;
      left: 10px;
      font-size: 18px;
    }

    .player {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      position: absolute;
    }

    #you { background: cyan; }
    #it { background: red; }

    .glow {
      box-shadow: 0 0 25px 12px currentColor;
    }

    #gameOver {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.85);
      display: none;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      font-size: 32px;
    }

    button {
      margin-top: 20px;
      font-size: 18px;
      padding: 10px 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div id="ui">
  ‚è± Time Remaining: <span id="playerTime">30</span><br>
  ‚ö° Challenger Time: <span id="challengerTime">30</span>
</div>

<div id="you" class="player"></div>
<div id="it" class="player glow"></div>

<div id="gameOver">
  <div id="result"></div>
  <button id="restart">Restart</button>
</div>

<script>
  const arenaW = window.innerWidth;
  const arenaH = window.innerHeight;

  const you = { el: document.getElementById("you"), x: 100, y: 100 };
  const it  = { el: document.getElementById("it"),  x: 400, y: 200 };

  let keys = {};
  let youAreIt;
  let playerTime;
  let challengerTime;
  let running;
  let loopId;
  let timerId;

  document.addEventListener("keydown", e => keys[e.key] = true);
  document.addEventListener("keyup", e => keys[e.key] = false);

  function clamp(p) {
    p.x = Math.max(0, Math.min(arenaW - 40, p.x));
    p.y = Math.max(0, Math.min(arenaH - 40, p.y));
  }

  function moveYou() {
    const speed = youAreIt ? 6 : 4;
    if (keys.ArrowUp) you.y -= speed;
    if (keys.ArrowDown) you.y += speed;
    if (keys.ArrowLeft) you.x -= speed;
    if (keys.ArrowRight) you.x += speed;
    clamp(you);
  }

  function moveIt() {
    const speed = youAreIt ? 3 : 5;
    if (it.x < you.x) it.x += speed;
    if (it.x > you.x) it.x -= speed;
    if (it.y < you.y) it.y += speed;
    if (it.y > you.y) it.y -= speed;
    clamp(it);
  }

  function checkTag() {
    const d = Math.hypot(you.x - it.x, you.y - it.y);
    if (d < 40) {
      youAreIt = !youAreIt;
      you.el.classList.toggle("glow", youAreIt);
      it.el.classList.toggle("glow", !youAreIt);
    }
  }

  function draw() {
    you.el.style.transform = `translate(${you.x}px, ${you.y}px)`;
    it.el.style.transform = `translate(${it.x}px, ${it.y}px)`;
    playerTimeEl.textContent = playerTime;
    challengerTimeEl.textContent = challengerTime;
  }

  function gameLoop() {
    if (!running) return;
    moveYou();
    moveIt();
    checkTag();
    draw();
    loopId = requestAnimationFrame(gameLoop);
  }

  function endGame(text) {
    running = false;
    cancelAnimationFrame(loopId);
    clearInterval(timerId);
    document.getElementById("result").textContent = text;
    document.getElementById("gameOver").style.display = "flex";
  }

  function startGame() {
    you.x = 100; you.y = 100;
    it.x = 400;  it.y = 200;

    youAreIt = false;
    playerTime = 30;
    challengerTime = 30;
    running = true;

    you.el.classList.remove("glow");
    it.el.classList.add("glow");

    document.getElementById("gameOver").style.display = "none";

    timerId = setInterval(() => {
      if (!running) return;

      playerTime--;
      challengerTime--;

      if (challengerTime <= 0) endGame("üí• You Lose!");
      if (playerTime <= 0) endGame("üèÜ You Win!");
    }, 1000);

    gameLoop();
  }

  const playerTimeEl = document.getElementById("playerTime");
  const challengerTimeEl = document.getElementById("challengerTime");

  document.getElementById("restart").onclick = startGame;

  startGame();
</script>

</body>
</html>
