<!DOCTYPE html>
<html>
<head>
  <title>Glow Tag v2</title>
  <style>
    body {
      margin: 0;
      background: #000;
      overflow: hidden;
      font-family: sans-serif;
      color: white;
    }

    #ui {
      position: fixed;
      top: 10px;
      left: 10px;
      font-size: 18px;
      line-height: 1.5;
    }

    .player {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      position: absolute;
    }

    #you {
      background: cyan;
    }

    #it {
      background: red;
    }

    .glow {
      box-shadow: 0 0 25px 12px currentColor;
    }

    #gameOver {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.85);
      display: none;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      font-size: 32px;
      z-index: 10;
    }

    button {
      margin-top: 20px;
      font-size: 18px;
      padding: 10px 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div id="ui">
  ‚è± Player Time: <span id="time">30</span><br>
  ‚ö° Challenger Time: <span id="challengerTime">30</span><br>
  </div>

<div id="you" class="player"></div>
<div id="it" class="player glow"></div>

<div id="gameOver">
  <div id="result"></div>
  <button onclick="restartGame()">Restart</button>
</div>

<script>
  const arenaWidth = window.innerWidth;
  const arenaHeight = window.innerHeight;

  const you = { el: document.getElementById("you"), x: 100, y: 100 };
  const it  = { el: document.getElementById("it"),  x: 400, y: 200 };

  let youAreIt = false;
  let score = 0;
  let playerTime = 30;
  let challengerTime = 30;
  let gameRunning = true;

  const keys = {};

  document.addEventListener("keydown", e => {
    if (["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)) {
      e.preventDefault();
    }
    keys[e.key] = true;
  });

  document.addEventListener("keyup", e => {
    keys[e.key] = false;
  });

  function clamp(player) {
    player.x = Math.max(0, Math.min(arenaWidth - 40, player.x));
    player.y = Math.max(0, Math.min(arenaHeight - 40, player.y));
  }

  function moveYou() {
    const speed = youAreIt ? 6 : 4;
    if (keys.ArrowUp) you.y -= speed;
    if (keys.ArrowDown) you.y += speed;
    if (keys.ArrowLeft) you.x -= speed;
    if (keys.ArrowRight) you.x += speed;
    clamp(you);
  }

  function moveIt() {
    const speed = youAreIt ? 3 : 5;
    if (it.x < you.x) it.x += speed;
    if (it.x > you.x) it.x -= speed;
    if (it.y < you.y) it.y += speed;
    if (it.y > you.y) it.y -= speed;
    clamp(it);
  }

  function checkTag() {
    const dx = you.x - it.x;
    const dy = you.y - it.y;
    const distance = Math.hypot(dx, dy);

    if (distance < 40) {
      youAreIt = !youAreIt;
      score += 10;

      you.el.classList.toggle("glow", youAreIt);
      it.el.classList.toggle("glow", !youAreIt);
    }
  }

  function draw() {
    you.el.style.transform = `translate(${you.x}px, ${you.y}px)`;
    it.el.style.transform = `translate(${it.x}px, ${it.y}px)`;
    document.getElementById("score").textContent = score;
  }

  function gameLoop() {
    if (!gameRunning) return;
    moveYou();
    moveIt();
    checkTag();
    draw();
    requestAnimationFrame(gameLoop);
  }

  let timerInterval = setInterval(timerTick, 1000);

  function timerTick() {
    if (!gameRunning) return;

    if (youAreIt) {
      playerTime--;
      document.getElementById("time").textContent = playerTime;
      if (playerTime <= 0) endGame("üí• You Lose!");
    } else {
      challengerTime--;
      document.getElementById("challengerTime").textContent = challengerTime;
      if (challengerTime <= 0) endGame("üèÜ You Survived!");
    }
  }

  function endGame(message) {
    gameRunning = false;
    document.getElementById("gameOver").style.display = "flex";
    document.getElementById("result").textContent = message;
  }

  function restartGame() {
    gameRunning = true;
    youAreIt = false;
    score = 0;

    playerTime = 30;
    challengerTime = 30;

    document.getElementById("time").textContent = playerTime;
    document.getElementById("challengerTime").textContent = challengerTime;
    document.getElementById("score").textContent = score;
    document.getElementById("gameOver").style.display = "none";

    you.x = 100;
    you.y = 100;
    it.x = 400;
    it.y = 200;

    you.el.classList.remove("glow");
    it.el.classList.add("glow");

    clearInterval(timerInterval);
    timerInterval = setInterval(timerTick, 1000);

    gameLoop();
  }

  gameLoop();
</script>

</body>
</html>
